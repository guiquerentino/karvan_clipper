******************************************************************************

*****************************/FUN€AO CONSULTA HORA CUPOM**********************

SAVE SCREEN TO FTELA
SET CENT ON
IF ACESSO # 1 .OR. ALLTRIM(FUNCIONARIO) # "MARCELO"
OL_Yield() 
    ALERT('ACESSO NAO AUTORIZADO')               
    RETURN(.T.)
ENDIF
HORA7=0
HORA8=0
HORA9=0
HORA10=0
HORA11=0
HORA12=0
HORA13=0
HORA14=0
HORA15=0
HORA16=0
HORA17=0
HORA18=0
VALOR7=0
VALOR8=0
VALOR9=0
VALOR10=0
VALOR11=0
VALOR12=0
VALOR13=0
VALOR14=0
VALOR15=0
VALOR16=0
VALOR17=0
VALOR18=0
TOTAL=0
@ 04,15 CLEAR TO 10,64
@ 04,15 TO 10,64 DOUBLE

@ 07,16 SAY "DATA INICIAL:" GET DINICIO PICT "@D" VALID DINICIO <=DATE()
@ 08,16 SAY "DATA FINAL..:" GET DFINAL  PICT "@D" VALID DFINAL >=DINICIO
READ

CUPOM()
INDEX ON DTOS(D_NOT) TO D_NOT FOR D_NOT>=DINICIO .AND. D_NOT<=DFINAL

DO WHILE ! EOF()
        IF VAL(HORANOT)=7
                VALOR7=VALOR7+NOTTOTG
                HORA7++
        ENDIF
        IF VAL(HORANOT)=8
                VALOR8=VALOR8+NOTTOTG
                HORA8++
        ENDIF
        IF VAL(HORANOT)=9
                VALOR9=VALOR9+NOTTOTG
                HORA9++
        ENDIF
        IF VAL(HORANOT)=10
                VALOR10=VALOR10+NOTTOTG
                HORA10++
        ENDIF
        IF VAL(HORANOT)=11
                VALOR11=VALOR11+NOTTOTG
                HORA11++
        ENDIF
        IF VAL(HORANOT)=12
                VALOR12=VALOR12+NOTTOTG
                HORA12++
        ENDIF
        IF VAL(HORANOT)=13
                VALOR13=VALOR13+NOTTOTG
                HORA13++
        ENDIF
        IF VAL(HORANOT)=14
                VALOR14=VALOR14+NOTTOTG
                HORA14++
        ENDIF
        IF VAL(HORANOT)=15
                VALOR15=VALOR15+NOTTOTG
                HORA15++
        ENDIF
        IF VAL(HORANOT)=16
                VALOR16=VALOR16+NOTTOTG
                HORA16++
        ENDIF
        IF VAL(HORANOT)=17
                VALOR17=VALOR17+NOTTOTG
                HORA17++
        ENDIF
        IF VAL(HORANOT)=18
                VALOR18=VALOR18+NOTTOTG
                HORA18++
        ENDIF
        TOTAL=TOTAL+NOTTOTG
        SKIP
ENDDO

TOTAL1=VALOR7+VALOR8+VALOR9+VALOR10+VALOR11+VALOR12+VALOR13+VALOR14+VALOR15+VALOR16+VALOR17+VALOR18
REST SCREEN FROM FTELA

@ 00,01 CLEAR TO 24,35
@ 00,01 TO 24,35 DOUBLE
@ 01,02 SAY "07:00 AS 07:59..:"
@ 01,20 SAY HORA7 PICT "9999"
@ 01,25 SAY VALOR7 PICT "999,999.99"
@ 03,02 SAY "08:00 AS 08:59..:"
@ 03,20 SAY HORA8 PICT "9999"
@ 03,25 SAY VALOR8 PICT "999,999.99"
@ 05,02 SAY "09:00 AS 09:59..:"
@ 05,20 SAY HORA9 PICT "9999"
@ 05,25 SAY VALOR9 PICT "999,999.99"
@ 07,02 SAY "10:00 AS 10:59..:"
@ 07,20 SAY HORA10 PICT "9999"
@ 07,25 SAY VALOR10 PICT "999,999.99"
@ 09,02 SAY "11:00 AS 11:59..:"
@ 09,20 SAY HORA11 PICT "9999"
@ 09,25 SAY VALOR11 PICT "999,999.99"
@ 11,02 SAY "12:00 AS 12:59..:"
@ 11,20 SAY HORA12 PICT "9999"
@ 11,25 SAY VALOR12 PICT "999,999.99"
@ 13,02 SAY "13:00 AS 13:59..:"
@ 13,20 SAY HORA13 PICT "9999"
@ 13,25 SAY VALOR13 PICT "999,999.99"
@ 15,02 SAY "14:00 AS 14:59..:"
@ 15,20 SAY HORA14 PICT "9999"
@ 15,25 SAY VALOR14 PICT "999,999.99"
@ 17,02 SAY "15:00 AS 15:59..:"
@ 17,20 SAY HORA15 PICT "9999"
@ 17,25 SAY VALOR15 PICT "999,999.99"
@ 19,02 SAY "16:00 AS 16:59..:"
@ 19,20 SAY HORA16 PICT "9999"
@ 19,25 SAY VALOR16 PICT "999,999.99"
@ 21,02 SAY "17:00 AS 17:59..:"
@ 21,20 SAY HORA17 PICT "9999"
@ 21,25 SAY VALOR17 PICT "999,999.99"
@ 23,02 SAY "18:00 AS 18:59..:"
@ 23,20 SAY HORA18 PICT "9999"
@ 23,25 SAY VALOR18 PICT "999,999.99"
@ 24,02 SAY TOTAL PICT "9999,999.99"
@ 24,24 SAY TOTAL1 PICT "9999,999.99"
INKEY(0)
