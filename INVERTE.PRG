FUNCTION C_PECAS
PECAS()
ORDSETFOCUS("CODPECA")
MDIGITO=SPACE(01)
MCODPECA=SPACE(05)
BUSCANUMERO()
MCODNOVO=STRZERO(N1,5)
@ 10,10 CLEAR TO 14,30
@ 10,10 TO 14,30 DOUBLE
@ 11,11 SAY "N.ANTIGO:" GET MCODPECA PICT "@!"
@ 12,11 SAY "N.NOVO..:" GET MCODNOVO PICT "@!"
@ 13,11 SAY "DIGITO..." GET MDIGITO PICT "9"
READ
SEEK MCODPECA
IF FOUND()
        BLOQUEIO()
        REPLACE LOCAL   WITH MCODPECA
        REPLACE CODPECA WITH MCODNOVO
        REPLACE DIGITO  WITH MDIGITO
        UNLOCK
     ELSE
     OL_Yield()
        ALERT('CODIGO NAO ENCONTRADO')
        RETURN(0)
ENDIF
PEDCUP()
ORDSETFOCUS("PEDCOD")
NUMREG=1
DO WHILE ! EOF()
        GOTO NUMREG
        IF PEDCOD=MCODPECA
                BLOQUEIO()
                REPLACE PEDCOD WITH MCODNOVO
                UNLOCK
        ENDIF
        NUMREG++
ENDDO           

