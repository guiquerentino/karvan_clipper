CLS
CUPOM()
data=date            
@ 10,10 SAY "DIGITE A DATA FINAL..:" GET DATE PICT "@d"
READ
INDEX ON CODNOT TO CODNOT
DO WHILE CODIGO >= CODNOT 
    *IF CODNOT >=56001
        RLOCK()
        DELETE 
        UNLOCK
   * ENDIF
        SKIP
ENDDO
PEDCUPEX()
INDEX ON PEDNUM TO PEDNUM
DO WHILE CODIGO >= PEDNUM
    *IF PEDNUM >= 56001
        RLOCK()
        DELETE 
        UNLOCK
   * ENDIF
        SKIP
ENDDO
pack
CUPOMEX()
PACK


FUNCTION DADOS2
USE D:\KARVAN\DADOS SHARED

FUNCTION CHEQUE
USE D:\KARVAN\CHEQUE SHARED

FUNCTION CHEQUEEX
USE D:\KARVAN\CHEQUE EXCLUSIVE
DO WHILE NETERR() 
        SETCOLOR("W+*/R,N/W")
        ALERT ('EXISTE ARQUIVO(S) ABERTO EM OUTRO TERMINAL VERIFIQUE !!!')
        CHEQUEEX()
ENDDO

FUNCTION CLIENTES
USE D:\KARVAN\CLIENTES SHARED

FUNCTION ORCAM
USE D:\KARVAN\ORCA\ORCA SHARED

FUNCTION CLIENTEX
USE D:\KARVAN\CLIENTES EXCLUSIVE
DO WHILE NETERR() 
        SETCOLOR("W+*/R,N/W")
        ALERT ('EXISTE ARQUIVO(S) ABERTO EM OUTRO TERMINAL VERIFIQUE !!!')
        CLIENTEX()
ENDDO

FUNCTION CONFERE
USE D:\KARVAN\CONFERE SHARED

FUNCTION CUPOM
USE D:\KARVAN\CUPOM SHARED

FUNCTION CUPOMEX
USE D:\KARVAN\CUPOM EXCLUSIVE
DO WHILE NETERR() 
        SETCOLOR("W+*/R,N/W")
        ALERT ('EXISTE ARQUIVO(S) ABERTO EM OUTRO TERMINAL VERIFIQUE !!!')
        CUPOMEX()
ENDDO

FUNCTION FECHA
USE D:\KARVAN\FECHA SHARED

FUNCTION FORNEC
USE D:\KARVAN\FORNEC SHARED

FUNCTION FORNECEX
USE D:\KARVAN\FORNEC EXCLUSIVE
DO WHILE NETERR() 
        SETCOLOR("W+*/R,N/W")
        ALERT ('EXISTE ARQUIVO(S) ABERTO EM OUTRO TERMINAL VERIFIQUE !!!')
        FORNECEX()
ENDDO

FUNCTION FUNCEX
USE D:\KARVAN\FUNC EXCLUSIVE
DO WHILE NETERR() 
        SETCOLOR("W+*/R,N/W")
        ALERT ('EXISTE ARQUIVO(S) ABERTO EM OUTRO TERMINAL VERIFIQUE !!!')
        FUNCEX()
ENDDO

FUNCTION FUNCI
USE D:\KARVAN\FUNC SHARED

FUNCTION GARANTEX
USE D:\KARVAN\GARANTIA EXCLUSIVE
DO WHILE NETERR() 
        SETCOLOR("W+*/R,N/W")
        ALERT ('EXISTE ARQUIVO(S) ABERTO EM OUTRO TERMINAL VERIFIQUE !!!')
        GARANTEX()
ENDDO

FUNCTION GARANTIA
USE D:\KARVAN\GARANTIA SHARED

FUNCTION PECAS
USE D:\KARVAN\PECAS SHARED

FUNCTION P_100
USE D:\KARVAN\P_100 SHARED


FUNCTION P_100EX
USE D:\KARVAN\P_100 EXCLUSIVE
DO WHILE NETERR() 
        SETCOLOR("W+*/R,N/W")
        ALERT ('EXISTE ARQUIVO(S) ABERTO EM OUTRO TERMINAL VERIFIQUE !!!')
        P_100EX()
ENDDO

FUNCTION PECASEX
USE D:\KARVAN\PECAS EXCLUSIVE
DO WHILE NETERR() 
        SETCOLOR("W+*/R,N/W")
        ALERT ('EXISTE ARQUIVO(S) ABERTO EM OUTRO TERMINAL VERIFIQUE !!!')
        PECASEX()
ENDDO

FUNCTION PEDCUP
USE D:\KARVAN\PEDCUP SHARED

FUNCTION PEDCUPEX
USE D:\KARVAN\PEDCUP EXCLUSIVE
DO WHILE NETERR() 
        SETCOLOR("W+*/R,N/W")
        ALERT ('EXISTE ARQUIVO(S) ABERTO EM OUTRO TERMINAL VERIFIQUE !!!')
        PEDCUPEX()
ENDDO
